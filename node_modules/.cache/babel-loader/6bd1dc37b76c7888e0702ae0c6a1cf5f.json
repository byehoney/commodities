{"remainingRequest":"/Users/yanghaiqiang/Documents/testPro/commodities/node_modules/babel-loader/lib/index.js!/Users/yanghaiqiang/Documents/testPro/commodities/node_modules/eslint-loader/index.js??ref--13-0!/Users/yanghaiqiang/Documents/testPro/commodities/src/store/modules/login/index.js","dependencies":[{"path":"/Users/yanghaiqiang/Documents/testPro/commodities/src/store/modules/login/index.js","mtime":1557109635377},{"path":"/Users/yanghaiqiang/Documents/testPro/commodities/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanghaiqiang/Documents/testPro/commodities/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yanghaiqiang/Documents/testPro/commodities/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/yanghaiqiang/Documents/testPro/commodities/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/yanghaiqiang/Documents/testPro/commodities/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSON$stringify from \"/Users/yanghaiqiang/Documents/testPro/commodities/node_modules/@babel/runtime-corejs2/core-js/json/stringify\";\nimport * as type from './mutations_types';\nimport { login as _login } from 'api/index';\nimport { Toast } from 'mint-ui';\nexport default {\n  namespaced: true,\n  state: {\n    token: localStorage.getItem('token') || '',\n    user: JSON.parse(localStorage.getItem('userDate')) || {}\n  },\n  mutations: _defineProperty({}, type.LOGIN, function (state, data) {\n    var userDate = data.data;\n    state.token = userDate.token;\n    state.user = userDate;\n    localStorage.setItem('token', userDate.token);\n    localStorage.setItem('userDate', _JSON$stringify(userDate));\n  }),\n  actions: {\n    login: function () {\n      var _login2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(state, data) {\n        var res;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return _login({\n                  username: data.username,\n                  password: data.password\n                });\n\n              case 3:\n                res = _context.sent;\n                state.commit(type.LOGIN, res);\n                Toast({\n                  message: '登录成功',\n                  position: 'middle',\n                  duration: 2000\n                });\n                setTimeout(function () {\n                  var redirect = data.$route.query.redirect || '/';\n                  data.$router.replace({\n                    path: redirect\n                  });\n                }, 3000);\n                _context.next = 11;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](0);\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 9]]);\n      }));\n\n      function login(_x, _x2) {\n        return _login2.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  },\n  getters: {\n    token: function token(state) {\n      return state.token;\n    },\n    user: function user(state) {\n      console.log('state', state);\n      return state.user;\n    }\n  }\n};",{"version":3,"sources":["/Users/yanghaiqiang/Documents/testPro/commodities/src/store/modules/login/index.js"],"names":["type","login","Toast","namespaced","state","token","localStorage","getItem","user","JSON","parse","mutations","LOGIN","data","userDate","setItem","actions","username","password","res","commit","message","position","duration","setTimeout","redirect","$route","query","$router","replace","path","getters","console","log"],"mappings":";;;;;AAAA,OAAO,KAAKA,IAAZ,MAAsB,mBAAtB;AACA,SAASC,KAAK,IAALA,MAAT,QAAsB,WAAtB;AACA,SAASC,KAAT,QAAsB,SAAtB;AACA,eAAe;AACXC,EAAAA,UAAU,EAAE,IADD;AAEXC,EAAAA,KAAK,EAAE;AACHC,IAAAA,KAAK,EAAEC,YAAY,CAACC,OAAb,CAAqB,OAArB,KAAiC,EADrC;AAEHC,IAAAA,IAAI,EAAEC,IAAI,CAACC,KAAL,CAAWJ,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAX,KAAgD;AAFnD,GAFI;AAMXI,EAAAA,SAAS,sBACJX,IAAI,CAACY,KADD,YACQR,KADR,EACeS,IADf,EACqB;AACtB,QAAIC,QAAQ,GAAGD,IAAI,CAACA,IAApB;AACAT,IAAAA,KAAK,CAACC,KAAN,GAAcS,QAAQ,CAACT,KAAvB;AACAD,IAAAA,KAAK,CAACI,IAAN,GAAaM,QAAb;AACAR,IAAAA,YAAY,CAACS,OAAb,CAAqB,OAArB,EAA8BD,QAAQ,CAACT,KAAvC;AACAC,IAAAA,YAAY,CAACS,OAAb,CAAqB,UAArB,EAAiC,gBAAeD,QAAf,CAAjC;AACH,GAPI,CANE;AAeXE,EAAAA,OAAO,EAAE;AACCf,IAAAA,KADD;AAAA;AAAA;AAAA,+CACOG,KADP,EACcS,IADd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAGmBZ,MAAK,CAAC;AAClBgB,kBAAAA,QAAQ,EAAEJ,IAAI,CAACI,QADG;AAElBC,kBAAAA,QAAQ,EAAEL,IAAI,CAACK;AAFG,iBAAD,CAHxB;;AAAA;AAGOC,gBAAAA,GAHP;AAOGf,gBAAAA,KAAK,CAACgB,MAAN,CAAapB,IAAI,CAACY,KAAlB,EAAyBO,GAAzB;AACAjB,gBAAAA,KAAK,CAAC;AACFmB,kBAAAA,OAAO,EAAE,MADP;AAEFC,kBAAAA,QAAQ,EAAE,QAFR;AAGFC,kBAAAA,QAAQ,EAAE;AAHR,iBAAD,CAAL;AAKAC,gBAAAA,UAAU,CAAC,YAAM;AACb,sBAAMC,QAAQ,GAAGZ,IAAI,CAACa,MAAL,CAAYC,KAAZ,CAAkBF,QAAlB,IAA8B,GAA/C;AACAZ,kBAAAA,IAAI,CAACe,OAAL,CAAaC,OAAb,CAAqB;AACjBC,oBAAAA,IAAI,EAAEL;AADW,mBAArB;AAGH,iBALS,EAKP,IALO,CAAV;AAbH;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,GAfE;AAuCXM,EAAAA,OAAO,EAAE;AACL1B,IAAAA,KADK,iBACCD,KADD,EACQ;AACT,aAAOA,KAAK,CAACC,KAAb;AACH,KAHI;AAILG,IAAAA,IAJK,gBAIAJ,KAJA,EAIO;AACR4B,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB7B,KAArB;AACA,aAAOA,KAAK,CAACI,IAAb;AACH;AAPI;AAvCE,CAAf","sourcesContent":["import * as type from './mutations_types'\r\nimport { login } from 'api/index'\r\nimport { Toast } from 'mint-ui';\r\nexport default {\r\n    namespaced: true,\r\n    state: {\r\n        token: localStorage.getItem('token') || '',\r\n        user: JSON.parse(localStorage.getItem('userDate')) || {}\r\n    },\r\n    mutations: {\r\n        [type.LOGIN](state, data) {\r\n            let userDate = data.data;\r\n            state.token = userDate.token;\r\n            state.user = userDate;\r\n            localStorage.setItem('token', userDate.token)\r\n            localStorage.setItem('userDate', JSON.stringify(userDate))\r\n        }\r\n    },\r\n    actions: {\r\n        async login(state, data) {\r\n            try {\r\n                let res = await login({\r\n                    username: data.username,\r\n                    password: data.password\r\n                })\r\n                state.commit(type.LOGIN, res);\r\n                Toast({\r\n                    message: '登录成功',\r\n                    position: 'middle',\r\n                    duration: 2000\r\n                });\r\n                setTimeout(() => {\r\n                    const redirect = data.$route.query.redirect || '/';\r\n                    data.$router.replace({\r\n                        path: redirect\r\n                    })\r\n                }, 3000);\r\n            } catch (error) {\r\n\r\n            }\r\n        }\r\n    },\r\n    getters: {\r\n        token(state) {\r\n            return state.token\r\n        },\r\n        user(state) {\r\n            console.log('state', state);\r\n            return state.user\r\n        }\r\n    }\r\n}\r\n"]}]}